{% extends 'base.html' %}
{%block title %} Visualizing Cities: {{city}}{%endblock title %}
{% block body %}

<div class="row">
  <div class="col-sm-3">
    <div style="margin-top:10px;">
      <span style="font-weight:bold; margin-left:20px;" class="header-5">Visualizing Cities</span>
    </div>
    <div id="filter-container" style="border:1px solid #ccc; width:210px; height:500px; position:fixed; top:60px; border-radius: 6px; padding:10px 10px 16px 10px;">
      <div style="font-size:18px; margin-bottom:14px;">Filters</div>
        
      <table class="filter-list" style="margin-bottom:3px;">
        <tr>
          <td style="width:70px; font-size:11px; font-weight:bold; padding-bottom:6px;">Month</td>
          <td style="font-size:11px; padding-bottom:6px;">
            <div class="dropdown">
              <button class="btn btn-default dropdown-toggle btn-sm btn-compact" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true" style="border-color:#fff;">
                Air quality
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Air quality</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Noise</a></li>
                <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Dust</a></li>
              </ul>
            </div>
          </td>
        </tr>
        <tr>
          <td id="filter-month-buttons"></td>
          <td id="filter-month-chart" style="text-align:top;"></td>
        </tr>
      </table>

      <table class="filter-list" style="margin-bottom:3px; margin-top:20px;">
        <tr>
          <td style="width:70px; font-size:11px; font-weight:bold; padding-bottom:9px;">Time of day</td>
          <td style="font-size:11px; padding-bottom:6px;"></td>
        </tr>
        <tr>
          <td id="filter-time-buttons"></td>
          <td id="filter-time-chart"></td>
        </tr>
      </table>
      <div style="margin-top:30px;">
        <button id="reset-filters" class="btn btn-default btn-sm" style="width:100%;">Reset filters</button>
      </div>
    </div>
  </div>
  <div class="col-sm-9">
    <div style="margin-top:10px;">
      <span style="font-weight:bold;">Shanghai</span> - <a href="{{url_for('city', name='Singapore')}}">Singapore</a> - Bangalore - Geneva - Rio de Janeiro - Boston - San Francisco
    </div>
  </div>
</div>
<div class="row">
  <div class="col-sm-3"></div>
  <div class="col-sm-9">
    <div class="row">
      <div class="col-sm-12">
        <div class="header-1">{{city}}</div>
        <p>
          Using readings from 14 batteries of sensors located throughout {{city}}, a picture of the city emerges through data. With this information, questions about the quality of life can start to be answered: How often is the air unhealthy? What time of day does the air tend to be bad? How noisy is it at night? Is there much sunlight in winter?
        <p>
          Below are interactive charts that depict information about air quality, noise, dust, light levels, temperature and humidity, that can answer these questions and more. 
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12">
        <div class="header-2">Air Quality</div>
        <p>
          Air quality is measured by the air quality index, or AQI, a standard maintained by the U.S. Environmental Protection Agency. It takes into consideration five major air pollutants: ground-level ozone, particle pollution, carbon monoxide, sulfur dioxide, and nitrogen dioxide. AQI values span from 0 to 500, with 0 being clean and 500 being extremely hazardous.
        <!--
        <div class="header-3">Air Quality Ranking</div>
        <p>
          From <strong>January</strong> to <strong>March</strong>, only using data collected between <strong>4PM</strong> and <strong>6PM</strong>, Shanghai's air average air quality score ranked <strong>7th</strong> out of the <strong>7</strong> cities being tracked. Its average air quality index score was <strong>54</strong>, which is moderately harmful. 
        -->
        <ul class='inline-list header' style="width:100%;">
          <li style="width:50%;">
            <div class="chart-header">Air Quality Comparison</div>
          </li>
          <li style="width:50%; text-align:right; padding-top:26px;">
            <span class="small-text">Sort by</span>&nbsp;
            <div class="btn-group"  id="airquality_raw-sort" role="group" aria-label="">
              <button type="button" name="sort" value="lower" id="lower" class="btn btn-default btn-sm btn-compact-2">Low</button>
              <button type="button" name="sort" value="median" id="median" class="btn btn-default btn-sm btn-compact-2 on">Median</button>
              <button type="button" name="sort" value="upper" id="upper" class="btn btn-default btn-sm btn-compact-2">High</button>
            </div>
          </li>
        </ul>  
        <p>
          The chart below shows the low, median, and high AQI scores for each of the seven cities measured. Low scores are the 10th percentile, and high are the 90th. Cities are ranked by median scores.
        <div id="ranking-airquality_raw" class="chart-container"></div>
        <div style="font-size:11px; line-height:18px; margin-top:8px;">
          <strong>Air quality index key:</strong>&nbsp;
          <span contenteditable='false' class='dot good'>2</span> 0 to 50 good&nbsp;
          <span contenteditable='false' class='dot moderate'>2</span> 51 to 100 moderate&nbsp;
          <span contenteditable='false' class='dot unhealthy-mild'>2</span> 101 to 150 unhealth for sensitive groups&nbsp;
          <span contenteditable='false' class='dot unhealthy'>2</span> 151 to 200 unhealthy&nbsp;
          <span contenteditable='false' class='dot unhealthy-very'>2</span> 201 to 300 very unhealthy&nbsp;
          <span contenteditable='false' class='dot hazardous'>2</span> 301 to 500 hazardous.
        </div>
        <div class="chart-header">{{city}}'s Daily Air Quality</div>
        
        <div id="timeseries-airquality_raw" class="chart-container"></div>
      </div>
    </div>
  </div>
</div>
{% endblock body %}
{% block js %}
  <script type='text/javascript'>
  var data = {{data | safe}};
  var city = "{{city | safe}}";
  var fakeData = [
    {
      'dimension': 'airquality_raw',
      'chart': 'filter',
      'date_from': '2015-01-01',
      'date_to': '2015-03-15',
      'time_from': 'T17:00:00.000Z',
      'time_to': 'T19:00:00.000Z',
      'data': [
        {
          'dimension': 'airquality_raw',
          'chart': 'monthly',
          'data': [
            {
              'date': '2015-01-01',
              'median': 64
            } ,{
              'date': '2015-02-01',
              'median': 44
            } ,{
              'date': '2015-03-01',
              'median': 34
            }   
          ]
        },{
          'dimension': 'airquality_raw',
          'chart': 'time_of_day',
          'data': [
            {
              'name': '2am to 4am',
              'median': 14
            } ,{
              'name': '7am to 9am',
              'median': 54
            } ,{
              'name': '2pm to 4pm',
              'median': 49
            },{
              'name': '5pm to 7pm',
              'median': 62
            }
          ]
        } 
      ]
    },
    {
      'dimension': 'airquality_raw',
      'chart': 'timeseries',
      'date_from': '2015-01-01',
      'date_to': '2015-03-15',
      'time_from': 'T17:00:00.000Z',
      'time_to': 'T19:00:00.000Z',
      'data': [
        {
          'date': '2015-01-01',
          'max': 120,
          'upper': 100,
          'median': 64,
          'lower': 29,
          'min': 20
        },
        {
          'date': '2015-01-02',
          'max': 100,
          'upper': 87,
          'median': 54,
          'lower': 34,
          'min': 20
        },
        {
          'date': '2015-01-03',
          'max': 250,
          'upper': 175,
          'median': 154,
          'lower': 134,
          'min': 120
        },
        {
          'date': '2015-01-04',
          'max': 120,
          'upper': 64,
          'median': 20,
          'lower': 17,
          'min': 20
        },
        {
          'date': '2015-01-05',
          'max': 100,
          'upper': 93,
          'median': 67,
          'lower': 45,
          'min': 20
        },
        {
          'date': '2015-01-06',
          'max': 60,
          'upper': 84,
          'median': 23,
          'lower': 20,
          'min': 20
        },
        {
          'date': '2015-01-07',
          'max': 50,
          'upper': 80,
          'median':25,
          'lower': 14,
          'min': 20
        },
        {
          'date': '2015-01-08',
          'max': 180,
          'upper': 90,
          'median': 65,
          'lower': 14,
          'min': 20
        },
        {
          'date': '2015-01-09',
          'max': 186,
          'upper': 80,
          'median': 72,
          'lower': 14,
          'min': 20
        },
        {
          'date': '2015-01-10',
          'max': 250,
          'upper': 90,
          'median': 79,
          'lower': 14,
          'min': 20
        },
        {
          'date': '2015-01-11',
          'max': 150,
          'upper': 100,
          'median': 65,
          'lower': 14,
          'min': 20
        },
        {
          'date': '2015-01-12',
          'max': 120,
          'upper': 100,
          'median': 64,
          'lower': 29,
          'min': 20
        },
        {
          'date': '2015-01-13',
          'max': 100,
          'upper': 87,
          'median': 54,
          'lower': 34,
          'min': 20
        },
        {
          'date': '2015-01-14',
          'max': 150,
          'upper': 145,
          'median': 54,
          'lower': 34,
          'min': 20
        },
        {
          'date': '2015-01-15',
          'max': 120,
          'upper': 64,
          'median': 40,
          'lower': 32,
          'min': 20
        },
        {
          'date': '2015-01-16',
          'max': 100,
          'upper': 93,
          'median': 67,
          'lower': 45,
          'min': 20
        },
        {
          'date': '2015-01-17',
          'max': 60,
          'upper': 84,
          'median': 43,
          'lower': 30,
          'min': 20
        },
        {
          'date': '2015-01-18',
          'max': 50,
          'upper': 80,
          'median':55,
          'lower': 24,
          'min': 20
        },
        {
          'date': '2015-01-19',
          'max': 197,
          'upper': 90,
          'median': 50,
          'lower': 14,
          'min': 20
        },
        {
          'date': '2015-01-20',
          'max': 220,
          'upper': 180,
          'median': 125,
          'lower': 14,
          'min': 20
        },
        {
          'date': '2015-01-21',
          'max': 250,
          'upper': 90,
          'median': 65,
          'lower': 14,
          'min': 20
        },
        {
          'date': '2015-01-22',
          'max': 350,
          'upper': 100,
          'median': 65,
          'lower': 14,
          'min': 20
        }
      ]
    },
    {
      'dimension': 'airquality_raw',
      'chart': 'ranking',
      'date_from': '2015-01-01',
      'date_to': '2015-03-15',
      'time_from': 'T17:00:00.000Z',
      'time_to': 'T19:00:00.000Z',
      'data': [
        {
          'name': 'Shanghai',
          'upper': 70,
          'median': 54,
          'lower': 19
        },
        {
          'name': 'Singapore',
          'upper': 87,
          'median': 54,
          'lower': 34
        },
        {
          'name': 'Bangalore',
          'upper': 245,
          'median': 154,
          'lower': 134
        },
        {
          'name': 'Geneva',
          'upper': 34,
          'median': 20,
          'lower': 17
        },
        {
          'name': 'Rio de Janeiro',
          'upper': 93,
          'median': 67,
          'lower': 45
        },
        {
          'name': 'Boston',
          'upper': 44,
          'median': 23,
          'lower': 10
        },
        {
          'name': 'San Francisco',
          'upper': 30,
          'median': 25,
          'lower': 14
        }
      ]
    }
  ]
  </script>
  <script type="text/javascript" src="{{url_for('static', filename='js/chart.js')}}"></script>
  <script type="text/javascript" src="{{url_for('static', filename='js/filter.js')}}"></script>
  <script type="text/javascript" src="{{url_for('static', filename='js/boxplot.js')}}"></script>
  <script type="text/javascript" src="{{url_for('static', filename='js/areachart.js')}}"></script>
  <script type="text/javascript" src="{{url_for('static', filename='js/city.js')}}"></script>
{% endblock js %}

